<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>태그 입력 및 합치기</title>
<style>
  body {
    font-family: Arial, sans-serif;
  }
/* form 내의 모든 div에 적용될 스타일 */
#tag-form > div {
  display: flex; /* Flexbox 레이아웃 사용 */
  align-items: center; /* 세로 중앙 정렬 */
  margin-bottom: 10px; /* 각 행 사이의 간격 */
}

/* 라벨 스타일링 */
#tag-form label {
  flex: 0 0 200px; /* 라벨의 너비를 200px로 고정 */
  margin-right: 20px; /* 라벨과 입력 필드 사이의 간격 */
}

/* 입력 필드 스타일링 */
#tag-form input[type="text"] {
  flex: 1; /* 남은 공간을 모두 사용 */
  padding: 5px; /* 입력 필드 내부의 패딩 */
}

</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const inputs = document.querySelectorAll('.tag-input');
    const result = document.getElementById('result');

    // Load input values from localStorage and combine tags
    loadAndCombine();

    // Event listener for input changes
    inputs.forEach(input => {
        input.addEventListener('input', function() {
            // Save current input values to localStorage
            saveInputs();
            // Combine tags
            combineTags();
        });
    });

    function loadAndCombine() {
        inputs.forEach((input, index) => {
            // Load values from localStorage using index as part of key
            input.value = localStorage.getItem(`tag-input-${index}`) || '';
        });
        combineTags();
    }

    function saveInputs() {
        inputs.forEach((input, index) => {
            // Save each input value to localStorage using index as part of key
            localStorage.setItem(`tag-input-${index}`, input.value);
        });
    }

    function combineTags() {
        let tags = [];
        inputs.forEach(input => {
            // Process each input value
            input.value.split(',').forEach(tag => {
                const trimmedTag = tag.trim();
                if (trimmedTag) {
                    tags.push(trimmedTag);
                }
            });
        });
        // Display combined tags
        result.value = tags.join(', ');
    }

    // 파일 가져오기 기능
    document.getElementById('importButton').addEventListener('change', function(event) {
        const fileReader = new FileReader();
        fileReader.onload = function(event) {
            const contents = event.target.result;
            // 가정: 파일의 내용은 JSON 형식입니다.
            const data = JSON.parse(contents);
            for (const key in data) {
                if (data.hasOwnProperty(key)) {
                    const input = document.getElementById(key);
                    if (input) {
                        input.value = data[key];
                    }
                }
            }
            combineTags(); // 입력 필드 업데이트 후 태그 조합
        };
        fileReader.readAsText(event.target.files[0]);
    });

    // 파일 내보내기 기능
    document.getElementById('exportButton').addEventListener('click', function() {
        const data = {};
        inputs.forEach(input => {
            data[input.id] = input.value;
        });
        const jsonData = JSON.stringify(data);
        const blob = new Blob([jsonData], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'tags.json';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });
});
</script>
</head>
<body>
<h2>태그 입력</h2>
<form id="tag-form">
  <!-- 남성, 여성이 몇 명인지 -->
  <div>
      <label for="people-count">남성, 여성이 몇 명인지 (예: 1girl): </label>
      <input type="text" class="tag-input" id="people-count" placeholder="예: 1girl">
  </div>
  <!-- 작품 태그 -->
  <div>
      <label for="work-tags">작품 태그: </label>
      <input type="text" class="tag-input" id="work-tags" placeholder="작품 태그 입력">
  </div>
  <!-- 캐릭터 태그 -->
  <div>
      <label for="character-tags">캐릭터 태그: </label>
      <input type="text" class="tag-input" id="character-tags" placeholder="캐릭터 태그 입력">
  </div>
  <!-- 작가 태그 -->
  <div>
      <label for="author-tags">작가 태그: </label>
      <input type="text" class="tag-input" id="author-tags" placeholder="작가 태그 입력">
  </div>
  <!-- 화풍 관련 태그 -->
  <div>
      <label for="style-tags">화풍 관련 태그: </label>
      <input type="text" class="tag-input" id="style-tags" placeholder="화풍 관련 태그 입력">
  </div>
  <!-- 구도 태그 -->
  <div>
      <label for="composition-tags">구도 태그: </label>
      <input type="text" class="tag-input" id="composition-tags" placeholder="구도 태그 입력">
  </div>
  <!-- 기본 포즈 -->
  <div>
      <label for="basic-pose">기본 포즈 (예: sitting, standing): </label>
      <input type="text" class="tag-input" id="basic-pose" placeholder="예: sitting, standing">
  </div>
  <!-- 얼굴 관련 태그 -->
  <div>
      <label for="face-tags">얼굴 관련 태그: </label>
      <input type="text" class="tag-input" id="face-tags" placeholder="얼굴 관련 태그 입력">
  </div>
  <!-- 머리카락 관련 태그 -->
  <div>
      <label for="hair-tags">머리카락 관련 태그: </label>
      <input type="text" class="tag-input" id="hair-tags" placeholder="머리카락 관련 태그 입력">
  </div>
  <!-- 신체 관련 태그 -->
  <div>
      <label for="body-tags">신체 관련 태그: </label>
      <input type="text" class="tag-input" id="body-tags" placeholder="신체 관련 태그 입력">
  </div>
  <!-- 구체적인 자세 태그 -->
  <div>
      <label for="specific-pose-tags">구체적인 자세 태그: </label>
      <input type="text" class="tag-input" id="specific-pose-tags" placeholder="구체적인 자세 태그 입력">
  </div>
  <!-- 옷 관련 태그 -->
  <div>
      <label for="clothing-tags">옷 관련 태그: </label>
      <input type="text" class="tag-input" id="clothing-tags" placeholder="옷 관련 태그 입력">
  </div>
  <!-- 배경 태그 -->
  <div>
      <label for="background-tags">배경 태그: </label>
      <input type="text" class="tag-input" id="background-tags" placeholder="배경 태그 입력">
  </div>
  <!-- 퀄리티 관련 태그 -->
  <div>
      <label for="quality-tags">퀄리티 관련 태그: </label>
      <input type="text" class="tag-input" id="quality-tags" placeholder="퀄리티 관련 태그 입력">
  </div>
</form>
<h2>결과<button id="copyButton">클립보드에 복사</button></h2>
<textarea id="result" rows="10" cols="50"></textarea> <!-- textarea로 변경 -->
<!-- 파일 가져오기 입력 -->
<h2>파일 가져오기</h2>
<input type="file" id="importButton">

<!-- 파일 내보내기 버튼 -->
<h2>파일 내보내기</h2>
<button id="exportButton">내보내기</button>
<script>
// 클릭 이벤트 리스너를 복사 버튼에 추가합니다.
document.getElementById('copyButton').addEventListener('click', function() {
    // textarea의 내용을 선택합니다.
    const textarea = document.getElementById('result');
    textarea.select();
    // 선택한 텍스트를 클립보드에 복사합니다.
    document.execCommand('copy');

    // 사용자에게 복사가 완료되었음을 알리는 메시지를 표시할 수 있습니다.
    // 예: alert("클립보드에 복사되었습니다.");
});
</script>

</body>
</html>
